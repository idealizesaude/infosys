<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trocar senha – InfoSys</title>

  <!-- Segurança: redireciona se não autenticado direciona para index.html -->
  <script src="/js/seguranca.js" defer></script>
  
    <!-- Content Security Policy -->
  <meta http-equiv="Content-Security-Policy"
        content="
          default-src 'self';
          script-src 'self' 'unsafe-inline';
          style-src 'self' 'unsafe-inline';
          img-src 'self' data:;
          connect-src 'self'
                      https://script.google.com
                      https://script.googleusercontent.com
                      https://api.ipify.org;
        ">

  <link rel="icon" type="image/png" href="../assets/images/favicon.png" />
  <link rel="stylesheet" href="/css/alterar-senha.css" />
</head>
<body>
  <div class="card">
    <h2>Defina sua nova senha</h2>

    <form id="f">
      <div class="field">
        <span class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
        </span>
        <input type="password" id="nova" placeholder="Nova senha" required />
        <button type="button" class="toggle" id="tog1" aria-label="Mostrar senha">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2">
            <path d="M2.458 12C3.732 7.943 7.523 5 12 5s8.268 2.943 9.542 7c-1.274 4.057-5.065 7-9.542 7S3.732 16.057 2.458 12Z"/>
            <circle cx="12" cy="12" r="3"/>
          </svg>
        </button>
      </div>

      <div class="field">
        <span class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
        </span>
        <input type="password" id="conf" placeholder="Confirmar senha" required />
        <button type="button" class="toggle" id="tog2" aria-label="Mostrar senha">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2">
            <path d="M2.458 12C3.732 7.943 7.523 5 12 5s8.268 2.943 9.542 7c-1.274 4.057-5.065 7-9.542 7S3.732 16.057 2.458 12Z"/>
            <circle cx="12" cy="12" r="3"/>
          </svg>
        </button>
      </div>

      <div id="strength"></div>
      <button class="submit">Salvar</button>
      <div class="msg" id="msg"></div>
    </form>
  </div>

  <script type="module" src="/js/alterar-senha.js"></script>
</body>
</html>